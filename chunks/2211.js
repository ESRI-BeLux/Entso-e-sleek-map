"use strict";(self.webpackChunkentso_e_sleek_map_tester=self.webpackChunkentso_e_sleek_map_tester||[]).push([[2211],{92211:(e,t,r)=>{r.r(t),r.d(t,{assetMapFromAssetMapsJSON:()=>S,extractMesh:()=>d,meshFeatureSetFromJSON:()=>E});var n=r(50031),s=r(29287),a=r(3300),o=r(79238),u=r(62624),i=r(46803),c=r(2747),l=r(50507),f=r(64070),p=r(73110),m=r(45674);const h=()=>s.A.getLogger("esri.rest.support.meshFeatureSet");function E(e,t,r){const s=r.features;r.features=[],delete r.geometryType;const a=m.A.fromJSON(r);if(a.geometryType="mesh",!r.assetMaps)return a;const o=S(t,r.assetMaps),u=e.sourceSpatialReference??c.A.WGS84,i=r.globalIdFieldName,{outFields:l}=e,f=null!=l&&l.length>0?(p=l.includes("*")?null:new Set(l),({attributes:e})=>{if(!e)return{};if(!p)return e;for(const t in e)p.has(t)||delete e[t];return e}):()=>({});var p;for(const e of s){const r=d(e,i,u,t,o);null!=r&&a.features.push(new n.A({geometry:r,attributes:f(e)}))}return a}function d(e,t,r,n,s){const a=e.attributes[t],c=s.get(a);if(null==c)return h().error("mesh-feature-set:asset-not-found","Service returned a feature which was not found in the asset map",e),null;if(!e.geometry)return h().error("mesh-feature-set:no-geometry","Service returned a feature without geometry",e),null;const p=function({attributes:e},t,{transformFieldRoles:r}){const n=e[r.originX],s=e[r.originY],a=e[r.originZ];return new i.A({x:n,y:s,z:a,spatialReference:t})}(e,r,n),m=o.A.fromJSON(e.geometry);m.spatialReference=r;const E=function(e,{transformFieldRoles:t}){return new l.A({translation:[e[t.translationX],-e[t.translationZ],e[t.translationY]],rotationAxis:[e[t.rotationX],-e[t.rotationZ],e[t.rotationY]],rotationAngle:e[t.rotationDeg],scale:[e[t.scaleX],e[t.scaleZ],e[t.scaleY]]})}(e.attributes,n),d=r.isGeographic?"local":"georeferenced",y=function(e){const t=Array.from(e.files.values()),r=new Array;for(const e of t){if(e.status!==g.COMPLETED)return null;const t=new Array;for(const r of e.parts){if(!r)return null;t.push(new f.Bq(r.url,r.hash))}r.push(new f.Qp(e.name,e.mimeType,t))}return r}(c);return y?u.A.createWithExternalSource(p,y,{extent:m,transform:E,vertexSpace:d}):u.A.createIncomplete(p,{extent:m,transform:E,vertexSpace:d})}var g,y;function S(e,t){const r=new Map;for(const n of t){const t=n.parentGlobalId;if(null==t)continue;const s=n.assetName,o=n.assetType,u=n.assetHash,i=n.assetURL,c=n.conversionStatus,l=n.seqNo,f=(0,p.Fm)(o,e.supportedFormats);if(!f){h().error("mesh-feature-set:unknown-format",`Service returned an asset of type ${o}, but it does not list it as a supported type`);continue}const m=(0,a.tE)(r,t,(()=>({files:new Map})));(0,a.tE)(m.files,s,(()=>({name:s,type:o,mimeType:f,status:A(c),parts:[]}))).parts[l]={hash:u,url:i}}return r}function A(e){switch(e){case"COMPLETED":case"SUBMITTED":return g.COMPLETED;case"INPROGRESS":return g.PENDING;default:return g.FAILED}}(y=g||(g={}))[y.FAILED=0]="FAILED",y[y.PENDING=1]="PENDING",y[y.COMPLETED=2]="COMPLETED"}}]);